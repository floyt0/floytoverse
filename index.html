<!doctype html>
<html lang="pl">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Najnowszy film YouTube (API)</title>
</head>
<body>
  <h1>Najnowszy film na kanale</h1>

  <div>
    <input id="apiKey" value="AIzaSyAAVM-0rB-Vswo0i7cyxzOvns8jQA_Wgfk" style="width:300px" />
  </div>
  <div>
    <input id="channelId" placeholder="Channel ID" style="width:300px" />
  </div>
  <button id="loadBtn">Pokaż najnowszy film</button>

  <div id="status" style="margin-top:10px;color:darkred"></div>
  <div id="result" style="margin-top:15px"></div>

  <script>
    async function fetchLatestVideo(apiKey, channelId){
      const url = `https://www.googleapis.com/youtube/v3/search?key=${apiKey}&channelId=${channelId}&order=date&part=snippet&type=video&maxResults=1`;
      document.getElementById('status').textContent = 'Ładowanie…';
      try{
        const res = await fetch(url);
        if(!res.ok) throw new Error('Błąd pobierania API ('+res.status+')');
        const data = await res.json();
        if(!data.items || !data.items.length) throw new Error('Brak filmów na kanale.');
        const video = data.items[0];
        const videoId = video.id.videoId;
        const title = video.snippet.title;
        const link = `https://www.youtube.com/watch?v=${videoId}`;
        document.getElementById('result').innerHTML = `<p><strong>${title}</strong><br><a href="${link}" target="_blank">${link}</a></p>`;
        document.getElementById('status').textContent = '';
      }catch(err){
        document.getElementById('status').textContent = '❗ ' + (err.message || 'Błąd.');
      }
    }

    document.getElementById('loadBtn').addEventListener('click', () => {
      const apiKey = document.getElementById('apiKey').value.trim();
      const channelId = document.getElementById('channelId').value.trim();
      if(!apiKey || !channelId){
        document.getElementById('status').textContent = 'Podaj API Key i Channel ID.';
        return;
      }
      fetchLatestVideo(apiKey, channelId);
    });
  </script>
</body>
</html>
